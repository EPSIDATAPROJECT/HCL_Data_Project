  <!DOCTYPE html>


<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8" />

  <!-- Set the viewport width to device width for mobile -->
  <meta name="viewport" content="width=device-width" />

  <title>OVR : Outil de visualisation Remera</title>
  
  <!-- Included CSS Files (Compressed) -->
  <link rel="stylesheet" href="stylesheets/foundation.min.css">
  <link rel="stylesheet" href="stylesheets/app.css">
  <link rel="stylesheet" href="stylesheets/multi-select.css">

  <script src="javascripts/modernizr.foundation.js"></script>
</head>
<body>

  <div class="banner">
    <div class="row">
        <div class="four columns centered">
        <img src="images/logo-remera.png"></div>
    </div>
    <div class="row centered">
      <div class="nine columns centered">
        <h1>Remera outil de visualisation</h1>
      </div>
    </div>
  </div>

  
	<a class="home_button radius button" href="index.html">Retour vers la page d'accueil</a>


  <div id="chart_content">
    <div class="row">
      <div id="chart_container" class="eight columns"></div>
      <div class="four columns">


<ul class="accordion">
  <li class="active">
    <div class="title">
      <h5>Malformations</h5>
    </div>
    <div class="content">
      <label for="Y74"><input type="checkbox" id="Y74" class="checkbox"> Quelque chose</label>
      <label for="Y75"><input type="checkbox" id="Y75" class="checkbox"> Un truc</label>
      <label for="Y76"><input type="checkbox" id="Y76" class="checkbox"> Un autre truc</label>
    </div>
  </li>
</ul>


        <a class="radius button" onclick="process_chart();">Générer graphique</a>
      </div>
      
    </div>
  </div>


  <!-- Included JS Files (Compressed) -->
  <script src="javascripts/jquery.js"></script>
  <script src="javascripts/foundation.min.js"></script>
  <script src="javascripts/jquery.multi-select.js"></script>
  <script src="javascripts/jquery.quicksearch.js"></script>
  <script src="javascripts/highcharts.js"></script>
  <!-- Initialize JS Plugins -->
  <script src="javascripts/app.js"></script>
  <script type="text/javascript">


   

var process_chart = function () {
var nb_check =  $('input:checked[type=checkbox]').length; 
var parametre = '{';

$('input:checked[type=checkbox]').each(function() {

    if(nb_check === 1) {
      parametre += '"'+$(this)[0].id+'":""';
    } else {
      parametre += '"'+$(this)[0].id+'":"",';
    }
    nb_check--;
  });


 parametre+='}';

console.log(parametre);
 var params = $.parseJSON(parametre);
 console.log(params);


$.ajax({
        url: 'request_csv.php',
        type:'POST',
        data: {
             fonction:'request',
             params: params,
        },
        success: function(data)
        {
          
           var test = $.parseJSON(data);


           var donnee = [];
            $.each(test, function (key, value){
              var name = $('label[for='+key+']')[0].textContent;
              donnee.push({name: name, y: value});
            });

            console.log(donnee);
            donnee.sort(sortByValue);
            console.log(donnee);

               $('#chart_container').highcharts({
                chart: {
                    type: 'pie'
                },
                title: {
                    text: 'Fruit Consumption'
                },
                xAxis: {
                    categories: ['Apples', 'Bananas', 'Oranges']
                },
                yAxis: {
                    title: {
                        text: 'Fruit eaten'
                    }
                },
                series: [{
                  type: 'pie',
                  name: 'Browser share',
                  data: donnee
                }]
            });
        }
    });

}

function sortByValue(a,b) {
   var x = a.y;
    var y = b.y;
    return ((x > y) ? -1 : ((x < y) ? 1 : 0));
}

  </script>

  
</body>
</html>
